<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
    <title>ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿßŸÑÿ¥ŸáÿßÿØÿßÿ™ - Blockchain</title>
      <script src="https://cdn.jsdelivr.net/npm/web3@1.10.0/dist/web3.min.js"></script>
      </head>
      <body>
        <h2>üîç ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿßŸÑÿ¥ŸáÿßÿØÿ©</h2>

          <label for="certificateID">ÿ±ŸÇŸÖ ÿßŸÑÿ¥ŸáÿßÿØÿ©:</label><br>
            <input type="text" id="certificateID" placeholder="ŸÖÿ´ŸÑ: CERT2025-001"><br><br>

              <button onclick="verifyCertificate()">ÿ™ÿ≠ŸÇŸÇ</button>

                <h3 id="result"></h3>

                  <script>
                      const contractAddress = "0xd9145CCE52D386f254917e481eB44e9943F39138";
                          const abi = [ // ‚Üê ABI ÿßŸÑŸÉÿßŸÖŸÑ ŸÖŸÜ Remix
                                {
                                        "inputs": [],
                                                "stateMutability": "nonpayable",
                                                        "type": "constructor"
                                                              },
                                                                    {
                                                                            "anonymous": false,
                                                                                    "inputs": [
                                                                                              { "indexed": false, "internalType": "string", "name": "certificateID", "type": "string" },
                                                                                                        { "indexed": false, "internalType": "string", "name": "cid", "type": "string" },
                                                                                                                  { "indexed": false, "internalType": "string", "name": "studentName", "type": "string" },
                                                                                                                            { "indexed": false, "internalType": "uint256", "name": "issuedAt", "type": "uint256" }
                                                                                                                                    ],
                                                                                                                                            "name": "CertificateIssued",
                                                                                                                                                    "type": "event"
                                                                                                                                                          },
                                                                                                                                                                {
                                                                                                                                                                        "inputs": [
                                                                                                                                                                                  { "internalType": "string", "name": "_certificateID", "type": "string" },
                                                                                                                                                                                            { "internalType": "string", "name": "_cid", "type": "string" },
                                                                                                                                                                                                      { "internalType": "string", "name": "_studentName", "type": "string" }
                                                                                                                                                                                                              ],
                                                                                                                                                                                                                      "name": "issueCertificate",
                                                                                                                                                                                                                              "outputs": [],
                                                                                                                                                                                                                                      "stateMutability": "nonpayable",
                                                                                                                                                                                                                                              "type": "function"
                                                                                                                                                                                                                                                    },
                                                                                                                                                                                                                                                          {
                                                                                                                                                                                                                                                                  "inputs": [
                                                                                                                                                                                                                                                                            { "internalType": "string", "name": "", "type": "string" }
                                                                                                                                                                                                                                                                                    ],
                                                                                                                                                                                                                                                                                            "name": "certificates",
                                                                                                                                                                                                                                                                                                    "outputs": [
                                                                                                                                                                                                                                                                                                              { "internalType": "string", "name": "cid", "type": "string" },
                                                                                                                                                                                                                                                                                                                        { "internalType": "string", "name": "studentName", "type": "string" },
                                                                                                                                                                                                                                                                                                                                  { "internalType": "string", "name": "certificateID", "type": "string" },
                                                                                                                                                                                                                                                                                                                                            { "internalType": "uint256", "name": "issuedAt", "type": "uint256" }
                                                                                                                                                                                                                                                                                                                                                    ],
                                                                                                                                                                                                                                                                                                                                                            "stateMutability": "view",
                                                                                                                                                                                                                                                                                                                                                                    "type": "function"
                                                                                                                                                                                                                                                                                                                                                                          },
                                                                                                                                                                                                                                                                                                                                                                                {
                                                                                                                                                                                                                                                                                                                                                                                        "inputs": [
                                                                                                                                                                                                                                                                                                                                                                                                  { "internalType": "string", "name": "_certificateID", "type": "string" }
                                                                                                                                                                                                                                                                                                                                                                                                          ],
                                                                                                                                                                                                                                                                                                                                                                                                                  "name": "getCertificate",
                                                                                                                                                                                                                                                                                                                                                                                                                          "outputs": [
                                                                                                                                                                                                                                                                                                                                                                                                                                    { "internalType": "string", "name": "", "type": "string" },
                                                                                                                                                                                                                                                                                                                                                                                                                                              { "internalType": "string", "name": "", "type": "string" },
                                                                                                                                                                                                                                                                                                                                                                                                                                                        { "internalType": "string", "name": "", "type": "string" },
                                                                                                                                                                                                                                                                                                                                                                                                                                                                  { "internalType": "uint256", "name": "", "type": "uint256" }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ],
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  "stateMutability": "view",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          "type": "function"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                },
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "inputs": [],
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      "name": "owner",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              "outputs": [
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        { "internalType": "address", "name": "", "type": "address" }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ],
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        "stateMutability": "view",
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                "type": "function"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ];

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              let web3;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  let contract;

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      window.addEventListener("load", async () => {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if (window.ethereum) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    web3 = new Web3(window.ethereum);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            await window.ethereum.request({ method: "eth_requestAccounts" });
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    contract = new web3.eth.Contract(abi, contractAddress);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          } else {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  alert("Ÿäÿ±ÿ¨Ÿâ ÿ™ÿ´ÿ®Ÿäÿ™ MetaMask!");
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            });

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                async function verifyCertificate() {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      const id = document.getElementById("certificateID").value.trim();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if (!id) return alert("Ÿäÿ±ÿ¨Ÿâ ÿ•ÿØÿÆÿßŸÑ ÿ±ŸÇŸÖ ÿßŸÑÿ¥ŸáÿßÿØÿ©");

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  try {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          const data = await contract.methods.getCertificate(id).call();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  if (data[0] === "") {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            document.getElementById("result").innerHTML = "‚ùå ÿßŸÑÿ¥ŸáÿßÿØÿ© ÿ∫Ÿäÿ± ŸÖŸàÿ¨ŸàÿØÿ©.";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    } else {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              document.getElementById("result").innerHTML = `
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ‚úÖ <b>ÿßŸÑÿ¥ŸáÿßÿØÿ© ŸÖŸàÿ´ŸÇÿ©</b><br>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      üë§ ÿßÿ≥ŸÖ ÿßŸÑÿ∑ÿßŸÑÿ®: ${data[1]}<br>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  üìÑ ÿ±ŸÇŸÖ ÿßŸÑÿ¥ŸáÿßÿØÿ©: ${data[2]}<br>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              üîó <a href="https://ipfs.io/ipfs/${data[0]}" target="_blank">ÿπÿ±ÿ∂ ÿßŸÑÿ¥ŸáÿßÿØÿ©</a><br>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          üïí ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿ•ÿµÿØÿßÿ± (Unix): ${data[3]}
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    `;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  } catch (err) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          console.error(err);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  document.getElementById("result").innerHTML = "‚ö†Ô∏è ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿßŸÑÿ™ÿ≠ŸÇŸÇ.";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              </script>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              </body>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              </html>